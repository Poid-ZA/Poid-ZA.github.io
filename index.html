<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Spinning Globe with Ticking Clock</title>
  <style>
    body {
      margin: 0;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      background-color: #1a1a1a;
      color: #ffffff;
      font-family: Arial, sans-serif;
    }
    h1 {
      font-size: 2.5rem;
      margin-bottom: 1rem;
    }
    .clock {
      font-size: 1.5rem;
      margin-bottom: 1rem;
      font-family: monospace;
    }
    canvas {
      width: 100%;
      max-width: 800px;
      height: 400px;
      display: block;
    }
  </style>
</head>
<body>
  <div id="root"></div>
  <script type="importmap">
    {
      "imports": {
        "three": "https://cdn.jsdelivr.net/npm/three@0.153.0/build/three.module.js"
      }
    }
  </script>
  <script type="module">
    import * as THREE from 'three';
    import { createRoot } from 'https://cdn.jsdelivr.net/npm/react-dom@18.2.0/client.js';
    import { useRef, useEffect, useState } from 'https://cdn.jsdelivr.net/npm/react@18.2.0/umd/react.production.min.js';

    function Clock() {
      const [time, setTime] = useState(new Date().toLocaleString('en-US', { 
        weekday: 'short', 
        year: 'numeric', 
        month: 'short', 
        day: 'numeric', 
        hour: '2-digit', 
        minute: '2-digit', 
        second: '2-digit', 
        hour12: false 
      }));

      useEffect(() => {
        const interval = setInterval(() => {
          setTime(new Date().toLocaleString('en-US', { 
            weekday: 'short', 
            year: 'numeric', 
            month: 'short', 
            day: 'numeric', 
            hour: '2-digit', 
            minute: '2-digit', 
            second: '2-digit', 
            hour12: false 
          }));
        }, 1000);
        return () => clearInterval(interval);
      }, []);

      return React.createElement('div', { className: 'clock' }, time);
    }

    function GlobeCanvas() {
      const canvasRef = useRef(null);

      useEffect(() => {
        const canvas = canvasRef.current;
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, canvas.width / canvas.height, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ canvas, alpha: true });
        renderer.setSize(canvas.width, canvas.height);

        // Globe
        const geometry = new THREE.SphereGeometry(1, 32, 32);
        const material = new THREE.MeshBasicMaterial({
          color: 0x1E90FF,
          wireframe: true,
        });
        const globe = new THREE.Mesh(geometry, material);
        scene.add(globe);

        // Signals
        const signals = [];
        const signalGeometry = new THREE.SphereGeometry(0.02, 16, 16);
        const signalMaterial = new THREE.MeshBasicMaterial({ color: 0xFFFF00 });

        // Continental coordinates (approx. lat/lon in degrees)
        const continents = [
          { name: 'North America', lat: 40, lon: -100 },
          { name: 'South America', lat: -10, lon: -60 },
          { name: 'Europe', lat: 50, lon: 10 },
          { name: 'Africa', lat: 0, lon: 20 },
          { name: 'Asia', lat: 30, lon: 100 },
          { name: 'Australia', lat: -25, lon: 135 },
        ];

        const latLonToVector3 = (lat, lon, radius) => {
          const phi = (90 - lat) * (Math.PI / 180);
          const theta = (lon + 180) * (Math.PI / 180);
          return new THREE.Vector3(
            -radius * Math.sin(phi) * Math.cos(theta),
            radius * Math.cos(phi),
            radius * Math.sin(phi) * Math.sin(theta)
          );
        };

        const createSignal = () => {
          const startContinent = continents[Math.floor(Math.random() * continents.length)];
          let endContinent = continents[Math.floor(Math.random() * continents.length)];
          if (startContinent === endContinent) {
            endContinent = continents[(continents.indexOf(startContinent) + 1) % continents.length];
          }

          const startPos = latLonToVector3(startContinent.lat, startContinent.lon, 1.05);
          const endPos = latLonToVector3(endContinent.lat, endContinent.lon, 1.05);
          const signal = new THREE.Mesh(signalGeometry, signalMaterial);
          signal.position.copy(startPos);
          scene.add(signal);

          return { mesh: signal, startPos, endPos, t: 0 };
        };

        for (let i = 0; i < 5; i++) {
          signals.push(createSignal());
        }

        camera.position.z = 2.5;

        const animate = () => {
          globe.rotation.y += 0.005;

          signals.forEach((signal, index) => {
            signal.t += 0.02;
            if (signal.t >= 1) {
              scene.remove(signal.mesh);
              signals.splice(index, 1);
              signals.push(createSignal());
            } else {
              signal.mesh.position.lerpVectors(signal.startPos, signal.endPos, signal.t);
            }
          });

          renderer.render(scene, camera);
          requestAnimationFrame(animate);
        };
        animate();

        const handleResize = () => {
          const width = canvas.clientWidth;
          const height = canvas.clientHeight;
          renderer.setSize(width, height);
          camera.aspect = width / height;
          camera.updateProjectionMatrix();
        };
        window.addEventListener('resize', handleResize);

        return () => {
          window.removeEventListener('resize', handleResize);
          renderer.dispose();
        };
      }, []);

      return React.createElement('canvas', {
        ref: canvasRef,
        className: 'canvas'
      });
    }

    function App() {
      return React.createElement('div', { className: 'container' },
        React.createElement('h1', null, 'Spinning Globe with Ticking Clock'),
        React.createElement(Clock),
        React.createElement(GlobeCanvas)
      );
    }

    const root = createRoot(document.getElementById('root'));
    root.render(React.createElement(App));
  </script>
</body>
</html>
